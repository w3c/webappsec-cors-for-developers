<!doctype html><html lang="en">
 <head>
  <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
  <title>CORS for Developers</title>
  <meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport">
<style data-fill-with="stylesheet">/******************************************************************************
 *                   Style sheet for the W3C specifications                   *
 *
 * Special classes handled by this style sheet include:
 *
 * Indices
 *   - .toc for the Table of Contents (<ol class="toc">)
 *     + <span class="secno"> for the section numbers
 *   - #toc for the Table of Contents (<nav id="toc">)
 *   - ul.index for Indices (<a href="#ref">term</a><span>, in §N.M</span>)
 *   - table.index for Index Tables (e.g. for properties or elements)
 *
 * Structural Markup
 *   - table.data for general data tables
 *     -> use 'scope' attribute, <colgroup>, <thead>, and <tbody> for best results !
 *     -> use <table class='complex data'> for extra-complex tables
 *     -> use <td class='long'> for paragraph-length cell content
 *     -> use <td class='pre'> when manual line breaks/indentation would help readability
 *   - dl.switch for switch statements
 *   - ol.algorithm for algorithms (helps to visualize nesting)
 *   - .figure and .caption (HTML4) and figure and figcaption (HTML5)
 *     -> .sidefigure for right-floated figures
 *   - ins/del
 *
 * Code
 *   - pre and code
 *
 * Special Sections
 *   - .note       for informative notes             (div, p, span, aside, details)
 *   - .example    for informative examples          (div, p, pre, span)
 *   - .issue      for issues                        (div, p, span)
 *   - .advisement for loud normative statements     (div, p, strong)
 *   - .annoying-warning for spec obsoletion notices (div, aside, details)
 *
 * Definition Boxes
 *   - pre.def   for WebIDL definitions
 *   - table.def for tables that define other entities (e.g. CSS properties)
 *   - dl.def    for definition lists that define other entitles (e.g. HTML elements)
 *
 * Numbering
 *   - .secno for section numbers in .toc and headings (<span class='secno'>3.2</span>)
 *   - .marker for source-inserted example/figure/issue numbers (<span class='marker'>Issue 4</span>)
 *   - ::before styled for CSS-generated issue/example/figure numbers:
 *     -> Documents wishing to use this only need to add
 *        figcaption::before,
 *        .caption::before { content: "Figure "  counter(figure);  }
 *        .example::before { content: "Example " counter(example); }
 *        .issue::before   { content: "Issue "   counter(issue);   }
 *
 * Header Stuff (ignore, just don't conflict with these classes)
 *   - .head for the header
 *   - .copyright for the copyright
 *
 * Miscellaneous
 *   - .overlarge for things that should be as wide as possible, even if
 *     that overflows the body text area. This can be used on an item or
 *     on its container, depending on the effect desired.
 *     Note that this styling basically doesn't help at all when printing,
 *     since A4 paper isn't much wider than the max-width here.
 *     It's better to design things to fit into a narrower measure if possible.
 *   - js-added ToC jump links (see fixup.js)
 *
 ******************************************************************************/

/******************************************************************************/
/*                                   Body                                     */
/******************************************************************************/

	body {
		counter-reset: example figure issue;

		/* Layout */
		max-width: 50em;               /* limit line length to 50em for readability   */
		margin: 0 auto;                /* center text within page                     */
		padding: 1.6em 1.5em 2em 50px; /* assume 16px font size for downlevel clients */
		padding: 1.6em 1.5em 2em calc(26px + 1.5em); /* leave space for status flag     */

		/* Typography */
		line-height: 1.5;
		font-family: sans-serif;
		widows: 2;
		orphans: 2;
		word-wrap: break-word;
		overflow-wrap: break-word;
		hyphens: auto;

		/* Colors */
		color: black;
		background: white top left fixed no-repeat;
		background-size: 25px auto;
	}


/******************************************************************************/
/*                         Front Matter & Navigation                          */
/******************************************************************************/

/** Header ********************************************************************/

	div.head { margin-bottom: 1em }
	div.head hr { border-style: solid; }

	div.head h1 {
		font-weight: bold;
		margin: 0 0 .1em;
		font-size: 220%;
	}

	div.head h2 { margin-bottom: 1.5em;}

/** W3C Logo ******************************************************************/

	.head .logo {
		float: right;
		margin: 0.4rem 0 0.2rem .4rem;
	}

	.head img[src*="logos/W3C"] {
		display: block;
		border: solid #1a5e9a;
		border-width: .65rem .7rem .6rem;
		border-radius: .4rem;
		background: #1a5e9a;
		color: white;
		font-weight: bold;
	}

	.head a:hover > img[src*="logos/W3C"],
	.head a:focus > img[src*="logos/W3C"] {
		opacity: .8;
	}

	.head a:active > img[src*="logos/W3C"] {
		background: #c00;
		border-color: #c00;
	}

	/* see also additional rules in Link Styling section */

/** Copyright *****************************************************************/

	p.copyright,
	p.copyright small { font-size: small }

/** Back to Top / ToC Toggle **************************************************/

	@media print {
		#toc-nav {
			display: none;
		}
	}
	@media not print {
		#toc-nav {
			position: fixed;
			z-index: 2;
			bottom: 0; left: 0;
			margin: 0;
			min-width: 1.33em;
			border-top-right-radius: 2rem;
			box-shadow: 0 0 2px;
			font-size: 1.5em;
			color: black;
		}
		#toc-nav > a {
			display: block;
			white-space: nowrap;

			height: 1.33em;
			padding: .1em 0.3em;
			margin: 0;

			background: white;
			box-shadow: 0 0 2px;
			border: none;
			border-top-right-radius: 1.33em;
			background: white;
		}
		#toc-nav > #toc-jump {
			padding-bottom: 2em;
			margin-bottom: -1.9em;
		}

		#toc-nav > a:hover,
		#toc-nav > a:focus {
			background: #f8f8f8;
		}
		#toc-nav > a:not(:hover):not(:focus) {
			color: #707070;
		}

		/* statusbar gets in the way on keyboard focus; remove once browsers fix */
		#toc-nav > a[href="#toc"]:not(:hover):focus:last-child {
			padding-bottom: 1.5rem;
		}

		#toc-nav:not(:hover) > a:not(:focus) > span + span {
			/* Ideally this uses :focus-within on #toc-nav */
			display: none;
		}
		#toc-nav > a > span + span {
			padding-right: 0.2em;
		}

		#toc-toggle-inline {
			vertical-align: 0.05em;
			font-size: 80%;
			color: gray;
			color: hsla(203,20%,40%,.7);
			border-style: none;
			background: transparent;
			position: relative;
		}
		#toc-toggle-inline:hover:not(:active),
		#toc-toggle-inline:focus:not(:active) {
			text-shadow: 1px 1px silver;
			top: -1px;
			left: -1px;
		}

		#toc-nav :active {
			color: #C00;
		}
	}

/** ToC Sidebar ***************************************************************/

	/* Floating sidebar */
	@media screen {
		body.toc-sidebar #toc {
			position: fixed;
			top: 0; bottom: 0;
			left: 0;
			width: 23.5em;
			max-width: 80%;
			max-width: calc(100% - 2em - 26px);
			overflow: auto;
			padding: 0 1em;
			padding-left: 42px;
			padding-left: calc(1em + 26px);
			background: inherit;
			background-color: #f7f8f9;
			z-index: 1;
			box-shadow: -.1em 0 .25em rgba(0,0,0,.1) inset;
		}
		body.toc-sidebar #toc h2 {
			margin-top: .8rem;
			font-variant: small-caps;
			font-variant: all-small-caps;
			text-transform: lowercase;
			font-weight: bold;
			color: gray;
			color: hsla(203,20%,40%,.7);
		}
		body.toc-sidebar #toc-jump:not(:focus) {
			width: 0;
			height: 0;
			padding: 0;
			position: absolute;
			overflow: hidden;
		}
	}
	/* Hide main scroller when only the ToC is visible anyway */
	@media screen and (max-width: 28em) {
		body.toc-sidebar {
			overflow: hidden;
		}
	}

	/* Sidebar with its own space */
	@media screen and (min-width: 78em) {
		body:not(.toc-inline) #toc {
			position: fixed;
			top: 0; bottom: 0;
			left: 0;
			width: 23.5em;
			overflow: auto;
			padding: 0 1em;
			padding-left: 42px;
			padding-left: calc(1em + 26px);
			background: inherit;
			background-color: #f7f8f9;
			z-index: 1;
			box-shadow: -.1em 0 .25em rgba(0,0,0,.1) inset;
		}
		body:not(.toc-inline) #toc h2 {
			margin-top: .8rem;
			font-variant: small-caps;
			font-variant: all-small-caps;
			text-transform: lowercase;
			font-weight: bold;
			color: gray;
			color: hsla(203,20%,40%,.7);
		}

		body:not(.toc-inline) {
			padding-left: 29em;
		}
		/* See also Overflow section at the bottom */

		body:not(.toc-inline) #toc-jump:not(:focus) {
			width: 0;
			height: 0;
			padding: 0;
			position: absolute;
			overflow: hidden;
		}
	}
	@media screen and (min-width: 90em) {
		body:not(.toc-inline) {
			margin: 0 4em;
		}
	}

/******************************************************************************/
/*                                Sectioning                                  */
/******************************************************************************/

/** Headings ******************************************************************/

	h1, h2, h3, h4, h5, h6, dt {
		page-break-after: avoid;
		page-break-inside: avoid;
		font: 100% sans-serif;   /* Reset all font styling to clear out UA styles */
		font-family: inherit;    /* Inherit the font family. */
		line-height: 1.2;        /* Keep wrapped headings compact */
		hyphens: manual;         /* Hyphenated headings look weird */
	}

	h2, h3, h4, h5, h6 {
		margin-top: 3rem;
	}

	h1, h2, h3 {
		color: #005A9C;
		background: transparent;
	}

	h1 { font-size: 170%; }
	h2 { font-size: 140%; }
	h3 { font-size: 120%; }
	h4 { font-weight: bold; }
	h5 { font-style: italic; }
	h6 { font-variant: small-caps; }
	dt { font-weight: bold; }

/** Subheadings ***************************************************************/

	h1 + h2,
	#subtitle {
		/* #subtitle is a subtitle in an H2 under the H1 */
		margin-top: 0;
	}
	h2 + h3,
	h3 + h4,
	h4 + h5,
	h5 + h6 {
		margin-top: 1.2em; /* = 1 x line-height */
	}

/** Section divider ***********************************************************/

	:not(.head) > hr {
		font-size: 1.5em;
		text-align: center;
		margin: 1em auto;
		height: auto;
		border: transparent solid 0;
		background: transparent;
	}
	:not(.head) > hr::before {
		content: "\2727\2003\2003\2727\2003\2003\2727";
	}

/******************************************************************************/
/*                            Paragraphs and Lists                            */
/******************************************************************************/

	p {
		margin: 1em 0;
	}

	dd > p:first-child,
	li > p:first-child {
		margin-top: 0;
	}

	ul, ol {
		margin-left: 0;
		padding-left: 2em;
	}

	li {
		margin: 0.25em 0 0.5em;
		padding: 0;
	}

	dl dd {
		margin: 0 0 .5em 2em;
	}

	.head dd + dd { /* compact for header */
		margin-top: -.5em;
	}

	/* Style for algorithms */
	ol.algorithm ol:not(.algorithm),
	.algorithm > ol ol:not(.algorithm) {
	 border-left: 0.5em solid #DEF;
	}

	/* Style for switch/case <dl>s */
	dl.switch > dd > ol.only,
	dl.switch > dd > .only > ol {
	 margin-left: 0;
	}
	dl.switch > dd > ol.algorithm,
	dl.switch > dd > .algorithm > ol {
	 margin-left: -2em;
	}
	dl.switch {
	 padding-left: 2em;
	}
	dl.switch > dt {
	 text-indent: -1.5em;
	 margin-top: 1em;
	}
	dl.switch > dt + dt {
	 margin-top: 0;
	}
	dl.switch > dt::before {
	 content: '\21AA';
	 padding: 0 0.5em 0 0;
	 display: inline-block;
	 width: 1em;
	 text-align: right;
	 line-height: 0.5em;
	}

/** Terminology Markup ********************************************************/


/******************************************************************************/
/*                                 Inline Markup                              */
/******************************************************************************/

/** Terminology Markup ********************************************************/
	dfn   { /* Defining instance */
		font-weight: bolder;
	}
	a > i { /* Instance of term */
		font-style: normal;
	}
	dt dfn code, code.idl {
		font-size: inherit;
	}
	dfn var {
		font-style: normal;
	}

/** Change Marking ************************************************************/

	del { color: red;  text-decoration: line-through; }
	ins { color: #080; text-decoration: underline;    }

/** Miscellaneous improvements to inline formatting ***************************/

	sup {
		vertical-align: super;
		font-size: 80%
	}

/******************************************************************************/
/*                                    Code                                    */
/******************************************************************************/

/** General monospace/pre rules ***********************************************/

	pre, code, samp {
		font-family: Menlo, Consolas, "DejaVu Sans Mono", Monaco, monospace;
		font-size: .9em;
		page-break-inside: avoid;
		hyphens: none;
		text-transform: none;
	}
	pre code,
	code code {
		font-size: 100%;
	}

	pre {
		margin-top: 1em;
		margin-bottom: 1em;
		overflow: auto;
	}

/** Inline Code fragments *****************************************************/

  /* Do something nice. */

/******************************************************************************/
/*                                    Links                                   */
/******************************************************************************/

/** General Hyperlinks ********************************************************/

	/* We hyperlink a lot, so make it less intrusive */
	a[href] {
		color: #034575;
		text-decoration: none;
		border-bottom: 1px solid #707070;
		/* Need a bit of extending for it to look okay */
		padding: 0 1px 0;
		margin: 0 -1px 0;
	}
	a:visited {
		border-bottom-color: #BBB;
	}

	/* Use distinguishing colors when user is interacting with the link */
	a[href]:focus,
	a[href]:hover {
		background: #f8f8f8;
		background: rgba(75%, 75%, 75%, .25);
		border-bottom-width: 3px;
		margin-bottom: -2px;
	}
	a[href]:active {
		color: #C00;
		border-color: #C00;
	}

	/* Backout above styling for W3C logo */
	.head .logo,
	.head .logo a {
		border: none;
		text-decoration: none;
		background: transparent;
	}

/******************************************************************************/
/*                                    Images                                  */
/******************************************************************************/

	img {
		border-style: none;
	}

	/* For autogen numbers, add
	   .caption::before, figcaption::before { content: "Figure " counter(figure) ". "; }
	*/

	figure, .figure, .sidefigure {
		page-break-inside: avoid;
		text-align: center;
		margin: 2.5em 0;
	}
	.figure img,    .sidefigure img,    figure img,
	.figure object, .sidefigure object, figure object {
		max-width: 100%;
		margin: auto;
	}
	.figure pre, .sidefigure pre, figure pre {
		text-align: left;
		display: table;
		margin: 1em auto;
	}
	.figure table, figure table {
		margin: auto;
	}
	@media screen and (min-width: 20em) {
		.sidefigure {
			float: right;
			width: 50%;
			margin: 0 0 0.5em 0.5em
		}
	}
	.caption, figcaption, caption {
		font-style: italic;
		font-size: 90%;
	}
	.caption::before, figcaption::before, figcaption > .marker {
		font-weight: bold;
	}
	.caption, figcaption {
		counter-increment: figure;
	}

	/* DL list is indented 2em, but figure inside it is not */
	dd > .figure, dd > figure { margin-left: -2em }

/******************************************************************************/
/*                             Colored Boxes                                  */
/******************************************************************************/

	.issue, .note, .example, .advisement, blockquote {
		padding: .5em;
		border: .5em;
		border-left-style: solid;
		page-break-inside: avoid;
	}
	span.issue, span.note {
		padding: .1em .5em .15em;
		border-right-style: solid;
	}

	.issue,
	.note,
	.example,
	.advisement,
	blockquote {
		margin: 1em auto;
	}
	.note  > p:first-child,
	.issue > p:first-child,
	blockquote > :first-child {
		margin-top: 0;
	}
	blockquote > :last-child {
		margin-bottom: 0;
	}

/** Blockquotes ***************************************************************/

	blockquote {
		border-color: silver;
	}

/** Open issue ****************************************************************/

	.issue {
		border-color: #E05252;
		background: #FBE9E9;
		counter-increment: issue;
		overflow: auto;
	}
	.issue::before, .issue > .marker {
		text-transform: uppercase;
		color: #AE1E1E;
		padding-right: 1em;
		text-transform: uppercase;
	}
	/* Add .issue::before { content: "Issue " counter(issue); } for autogen numbers,
	   or use class="marker" to mark up the issue number in source. */

/** Example *******************************************************************/

	.example {
		border-color: #E0CB52;
		background: #FCFAEE;
		counter-increment: example;
		overflow: auto;
		clear: both;
	}
	.example::before, .example > .marker {
		text-transform: uppercase;
		color: #827017;
		min-width: 7.5em;
		display: block;
	}
	/* Add .example::before { content: "Example " counter(example); } for autogen numbers,
	   or use class="marker" to mark up the example number in source. */

/** Non-normative Note ********************************************************/

	.note {
		border-color: #52E052;
		background: #E9FBE9;
		overflow: auto;
	}

	.note::before, .note > .marker,
	details.note > summary::before,
	details.note > summary > .marker {
		text-transform: uppercase;
		display: block;
		color: hsl(120, 70%, 30%);
	}
	/* Add .note::before { content: "Note"; } for autogen label,
	   or use class="marker" to mark up the label in source. */

	details.note > summary {
		display: block;
		color: hsl(120, 70%, 30%);
	}
	details.note[open] > summary {
		border-bottom: 1px silver solid;
	}

/** Advisement Box ************************************************************/
	/*  for attention-grabbing normative statements */

	.advisement {
		border-color: orange;
		border-style: none solid;
		background: #FFEECC;
	}
	strong.advisement {
		display: block;
		text-align: center;
	}
	.advisement > .marker {
		color: #B35F00;
	}

/** Spec Obsoletion Notice ****************************************************/
	/* obnoxious obsoletion notice for older/abandoned specs. */

	details {
		display: block;
	}
	summary {
		font-weight: bolder;
	}

	.annoying-warning:not(details),
	details.annoying-warning:not([open]) > summary,
	details.annoying-warning[open] {
		background: #fdd;
		color: red;
		font-weight: bold;
		padding: .75em 1em;
		border: thick red;
		border-style: solid;
		border-radius: 1em;
	}
	.annoying-warning :last-child {
		margin-bottom: 0;
	}

@media not print {
	details.annoying-warning[open] {
		position: fixed;
		left: 1em;
		right: 1em;
		bottom: 1em;
		z-index: 1000;
	}
}

	details.annoying-warning:not([open]) > summary {
		text-align: center;
	}

/** Entity Definition Boxes ***************************************************/

	.def {
		padding: .5em 1em;
		background: #DEF;
		margin: 1.2em 0;
		border-left: 0.5em solid #8CCBF2;
	}

/******************************************************************************/
/*                                    Tables                                  */
/******************************************************************************/

	th, td {
		text-align: left;
		text-align: start;
	}

/** Property/Descriptor Definition Tables *************************************/

	table.def {
		/* inherits .def box styling, see above */
		width: 100%;
		border-spacing: 0;
	}

	table.def td,
	table.def th {
		padding: 0.5em;
		vertical-align: baseline;
		border-bottom: 1px solid #bbd7e9;
	}

	table.def > tbody > tr:last-child th,
	table.def > tbody > tr:last-child td {
		border-bottom: 0;
	}

	table.def th {
		font-style: italic;
		font-weight: normal;
		padding-left: 1em;
		width: 3em;
	}

	/* For when values are extra-complex and need formatting for readability */
	table td.pre {
		white-space: pre-wrap;
	}

	/* A footnote at the bottom of a def table */
	table.def           td.footnote {
		padding-top: 0.6em;
	}
	table.def           td.footnote::before {
		content: " ";
		display: block;
		height: 0.6em;
		width: 4em;
		border-top: thin solid;
	}

/** Data tables (and properly marked-up index tables) *************************/
	/*
		 <table class="data"> highlights structural relationships in a table
		 when correct markup is used (e.g. thead/tbody, th vs. td, scope attribute)

		 Use class="complex data" for particularly complicated tables --
		 (This will draw more lines: busier, but clearer.)

		 Use class="long" on table cells with paragraph-like contents
		 (This will adjust text alignment accordingly.)
		 Alternately use class="longlastcol" on tables, to have the last column assume "long".
	*/

	table {
		word-wrap: normal;
		overflow-wrap: normal;
		hyphens: manual;
	}

	table.data,
	table.index {
		margin: 1em auto;
		border-collapse: collapse;
		border: hidden;
		width: 100%;
	}
	table.data caption,
	table.index caption {
		max-width: 50em;
		margin: 0 auto 1em;
	}

	table.data td,  table.data th,
	table.index td, table.index th {
		padding: 0.5em 1em;
		border-width: 1px;
		border-color: silver;
		border-top-style: solid;
	}

	table.data thead td:empty {
		padding: 0;
		border: 0;
	}

	table.data  thead,
	table.index thead,
	table.data  tbody,
	table.index tbody {
		border-bottom: 2px solid;
	}

	table.data colgroup,
	table.index colgroup {
		border-left: 2px solid;
	}

	table.data  tbody th:first-child,
	table.index tbody th:first-child  {
		border-right: 2px solid;
		border-top: 1px solid silver;
		padding-right: 1em;
	}

	table.data th[colspan],
	table.data td[colspan] {
		text-align: center;
	}

	table.complex.data th,
	table.complex.data td {
		border: 1px solid silver;
		text-align: center;
	}

	table.data.longlastcol td:last-child,
	table.data td.long {
	 vertical-align: baseline;
	 text-align: left;
	}

	table.data img {
		vertical-align: middle;
	}


/*
Alternate table alignment rules

	table.data,
	table.index {
		text-align: center;
	}

	table.data  thead th[scope="row"],
	table.index thead th[scope="row"] {
		text-align: right;
	}

	table.data  tbody th:first-child,
	table.index tbody th:first-child  {
		text-align: right;
	}

Possible extra rowspan handling

	table.data  tbody th[rowspan]:not([rowspan='1']),
	table.index tbody th[rowspan]:not([rowspan='1']),
	table.data  tbody td[rowspan]:not([rowspan='1']),
	table.index tbody td[rowspan]:not([rowspan='1']) {
		border-left: 1px solid silver;
	}

	table.data  tbody th[rowspan]:first-child,
	table.index tbody th[rowspan]:first-child,
	table.data  tbody td[rowspan]:first-child,
	table.index tbody td[rowspan]:first-child{
		border-left: 0;
		border-right: 1px solid silver;
	}
*/

/******************************************************************************/
/*                                  Indices                                   */
/******************************************************************************/


/** Table of Contents *********************************************************/

	.toc a {
		/* More spacing; use padding to make it part of the click target. */
		padding-top: 0.1rem;
		/* Larger, more consistently-sized click target */
		display: block;
		/* Reverse color scheme */
		color: black;
		border-color: #3980B5;
	}
	.toc a:visited {
		border-color: #054572;
	}
	.toc a:not(:focus):not(:hover) {
		/* Allow colors to cascade through from link styling */
		border-bottom-color: transparent;
	}

	.toc, .toc ol, .toc ul, .toc li {
		list-style: none; /* Numbers must be inlined into source */
		/* because generated content isn't search/selectable and markers can't do multilevel yet */
		margin:  0;
		padding: 0;
		line-height: 1.1rem; /* consistent spacing */
	}

	/* ToC not indented until third level, but font style & margins show hierarchy */
	.toc > li             { font-weight: bold;   }
	.toc > li li          { font-weight: normal; }
	.toc > li li li       { font-size:   95%;    }
	.toc > li li li li    { font-size:   90%;    }
	.toc > li li li li li { font-size:   85%;    }

	.toc > li             { margin: 1.5rem 0;    }
	.toc > li li          { margin: 0.3rem 0;    }
	.toc > li li li       { margin-left: 2rem;   }

	/* Section numbers in a column of their own */
	.toc .secno {
		float: left;
		width: 4rem;
		white-space: nowrap;
	}
	.toc > li li li li .secno {
		font-size: 85%;
	}
	.toc > li li li li li .secno {
		font-size: 100%;
	}

	:not(li) > .toc              { margin-left:  5rem; }
	.toc .secno                  { margin-left: -5rem; }
	.toc > li li li .secno       { margin-left: -7rem; }
	.toc > li li li li .secno    { margin-left: -9rem; }
	.toc > li li li li li .secno { margin-left: -11rem; }

	/* Tighten up indentation in narrow ToCs */
	@media (max-width: 30em) {
		:not(li) > .toc              { margin-left:  4rem; }
		.toc .secno                  { margin-left: -4rem; }
		.toc > li li li              { margin-left:  1rem; }
		.toc > li li li .secno       { margin-left: -5rem; }
		.toc > li li li li .secno    { margin-left: -6rem; }
		.toc > li li li li li .secno { margin-left: -7rem; }
	}
	@media screen and (min-width: 78em) {
		body:not(.toc-inline) :not(li) > .toc              { margin-left:  4rem; }
		body:not(.toc-inline) .toc .secno                  { margin-left: -4rem; }
		body:not(.toc-inline) .toc > li li li              { margin-left:  1rem; }
		body:not(.toc-inline) .toc > li li li .secno       { margin-left: -5rem; }
		body:not(.toc-inline) .toc > li li li li .secno    { margin-left: -6rem; }
		body:not(.toc-inline) .toc > li li li li li .secno { margin-left: -7rem; }
	}
	body.toc-sidebar #toc :not(li) > .toc              { margin-left:  4rem; }
	body.toc-sidebar #toc .toc .secno                  { margin-left: -4rem; }
	body.toc-sidebar #toc .toc > li li li              { margin-left:  1rem; }
	body.toc-sidebar #toc .toc > li li li .secno       { margin-left: -5rem; }
	body.toc-sidebar #toc .toc > li li li li .secno    { margin-left: -6rem; }
	body.toc-sidebar #toc .toc > li li li li li .secno { margin-left: -7rem; }

	.toc li {
		clear: both;
	}


/** Index *********************************************************************/

	/* Index Lists: Layout */
	ul.index       { margin-left: 0; columns: 15em; text-indent: 1em hanging; }
	ul.index li    { margin-left: 0; list-style: none; break-inside: avoid; }
	ul.index li li { margin-left: 1em }
	ul.index dl    { margin-top: 0; }
	ul.index dt    { margin: .2em 0 .2em 20px;}
	ul.index dd    { margin: .2em 0 .2em 40px;}
	/* Index Lists: Typography */
	ul.index ul,
	ul.index dl { font-size: smaller; }
	@media not print {
		ul.index li span {
			white-space: nowrap;
			color: transparent; }
		ul.index li a:hover + span,
		ul.index li a:focus + span {
			color: #707070;
		}
	}

/** Index Tables *****************************************************/
	/* See also the data table styling section, which this effectively subclasses */

	table.index {
		font-size: small;
		border-collapse: collapse;
		border-spacing: 0;
		text-align: left;
		margin: 1em 0;
	}

	table.index td,
	table.index th {
		padding: 0.4em;
	}

	table.index tr:hover td:not([rowspan]),
	table.index tr:hover th:not([rowspan]) {
		background: #f7f8f9;
	}

	/* The link in the first column in the property table (formerly a TD) */
	table.index th:first-child a {
		font-weight: bold;
	}

/******************************************************************************/
/*                                    Print                                   */
/******************************************************************************/

	@media print {
		/* Pages have their own margins. */
		html {
			margin: 0;
		}
		/* Serif for print. */
		body {
			font-family: serif;
		}
	}
	@page {
		margin: 1.5cm 1.1cm;
	}

/******************************************************************************/
/*                                    Legacy                                  */
/******************************************************************************/

	/* This rule is inherited from past style sheets. No idea what it's for. */
	.hide { display: none }



/******************************************************************************/
/*                             Overflow Control                               */
/******************************************************************************/

	.figure .caption, .sidefigure .caption, figcaption {
		/* in case figure is overlarge, limit caption to 50em */
		max-width: 50rem;
		margin-left: auto;
		margin-right: auto;
	}
	.overlarge > table {
		/* limit preferred width of table */
		max-width: 50em;
		margin-left: auto;
		margin-right: auto;
	}

	@media (min-width: 55em) {
		.overlarge {
			margin-left: calc(13px + 26.5rem - 50vw);
			margin-right: calc(13px + 26.5rem - 50vw);
			max-width: none;
		}
	}
	@media screen and (min-width: 78em) {
		body:not(.toc-inline) .overlarge {
			/* 30.5em body padding 50em content area */
			margin-left: calc(40em - 50vw) !important;
			margin-right: calc(40em - 50vw) !important;
		}
	}
	@media screen and (min-width: 90em) {
		body:not(.toc-inline) .overlarge {
			/* 4em html margin 30.5em body padding 50em content area */
			margin-left: 0 !important;
			margin-right: calc(84.5em - 100vw) !important;
		}
	}

	@media not print {
		.overlarge {
			overflow-x: auto;
			/* See Lea Verou's explanation background-attachment:
			 * http://lea.verou.me/2012/04/background-attachment-local/
			 *
			background: top left  / 4em 100% linear-gradient(to right,  #ffffff, rgba(255, 255, 255, 0)) local,
			            top right / 4em 100% linear-gradient(to left, #ffffff, rgba(255, 255, 255, 0)) local,
			            top left  / 1em 100% linear-gradient(to right,  #c3c3c5, rgba(195, 195, 197, 0)) scroll,
			            top right / 1em 100% linear-gradient(to left, #c3c3c5, rgba(195, 195, 197, 0)) scroll,
			            white;
			background-repeat: no-repeat;
			*/
		}
	}
</style>
  <meta content="Bikeshed 1.0.0" name="generator">
<style>

	.accessControlTable {
		width: 100%;
		border-collapse: collapse;
	}

	.accessControlTable td, th{
		border: 1px solid #000;
		padding: 0.5rem;
		margin: 0px;
	}


	.allowed {
		background-color: #aea;
	}

	.disallowed {
		background-color: #eaa;
	}

	.partial {
		background-color: #eea;
	}

</style>
<style>/* style-md-lists */

            /* This is a weird hack for me not yet following the commonmark spec
               regarding paragraph and lists. */
            [data-md] > :first-child {
                margin-top: 0;
            }
            [data-md] > :last-child {
                margin-bottom: 0;
            }</style>
<style>/* style-counters */

            body {
                counter-reset: example figure issue;
            }
            .issue {
                counter-increment: issue;
            }
            .issue:not(.no-marker)::before {
                content: "Issue " counter(issue);
            }

            .example {
                counter-increment: example;
            }
            .example:not(.no-marker)::before {
                content: "Example " counter(example);
            }
            .invalid.example:not(.no-marker)::before,
            .illegal.example:not(.no-marker)::before {
                content: "Invalid Example" counter(example);
            }

            figure {
                counter-increment: figure;
            }
            figcaption:not(.no-marker)::before {
                content: "Figure " counter(figure);
            }</style>
<style>/* style-selflinks */

            .heading, .issue, .note, .example, li, dt {
                position: relative;
            }
            a.self-link {
                position: absolute;
                top: 0;
                left: calc(-1 * (3.5rem - 26px));
                width: calc(3.5rem - 26px);
                height: 2em;
                text-align: center;
                border: none;
                transition: opacity .2s;
                opacity: .5;
            }
            a.self-link:hover {
                opacity: 1;
            }
            .heading > a.self-link {
                font-size: 83%;
            }
            li > a.self-link {
                left: calc(-1 * (3.5rem - 26px) - 2em);
            }
            dfn > a.self-link {
                top: auto;
                left: auto;
                opacity: 0;
                width: 1.5em;
                height: 1.5em;
                background: gray;
                color: white;
                font-style: normal;
                transition: opacity .2s, background-color .2s, color .2s;
            }
            dfn:hover > a.self-link {
                opacity: 1;
            }
            dfn > a.self-link:hover {
                color: black;
            }

            a.self-link::before            { content: "¶"; }
            .heading > a.self-link::before { content: "§"; }
            dfn > a.self-link::before      { content: "#"; }</style>
<style>/* style-autolinks */

            .css.css, .property.property, .descriptor.descriptor {
                color: #005a9c;
                font-size: inherit;
                font-family: inherit;
            }
            .css::before, .property::before, .descriptor::before {
                content: "‘";
            }
            .css::after, .property::after, .descriptor::after {
                content: "’";
            }
            .property, .descriptor {
                /* Don't wrap property and descriptor names */
                white-space: nowrap;
            }
            .type { /* CSS value <type> */
                font-style: italic;
            }
            pre .property::before, pre .property::after {
                content: "";
            }
            [data-link-type="property"]::before,
            [data-link-type="propdesc"]::before,
            [data-link-type="descriptor"]::before,
            [data-link-type="value"]::before,
            [data-link-type="function"]::before,
            [data-link-type="at-rule"]::before,
            [data-link-type="selector"]::before,
            [data-link-type="maybe"]::before {
                content: "‘";
            }
            [data-link-type="property"]::after,
            [data-link-type="propdesc"]::after,
            [data-link-type="descriptor"]::after,
            [data-link-type="value"]::after,
            [data-link-type="function"]::after,
            [data-link-type="at-rule"]::after,
            [data-link-type="selector"]::after,
            [data-link-type="maybe"]::after {
                content: "’";
            }

            [data-link-type].production::before,
            [data-link-type].production::after,
            .prod [data-link-type]::before,
            .prod [data-link-type]::after {
                content: "";
            }

            [data-link-type=element],
            [data-link-type=element-attr] {
                font-family: Menlo, Consolas, "DejaVu Sans Mono", monospace;
                font-size: .9em;
            }
            [data-link-type=element]::before { content: "<" }
            [data-link-type=element]::after  { content: ">" }

            [data-link-type=biblio] {
                white-space: pre;
            }</style>
 <body class="h-entry">
  <div class="head">
   <p data-fill-with="logo"></p>
   <h1 class="p-name no-ref" id="title">CORS for Developers</h1>
   <h2 class="no-num no-toc no-ref heading settled" id="subtitle"><span class="content">W3C Working Group Note, <time class="dt-updated" datetime="2016-09-27">27 September 2016</time></span></h2>
   <div data-fill-with="spec-metadata">
    <dl>
     <dt>This version:
     <dd><a class="u-url" href="http://www.w3.org/TR/2016/NOTE-cors-for-developers-1-20160927/">http://www.w3.org/TR/2016/NOTE-cors-for-developers-1-20160927/</a>
     <dt>Editor's Draft:
     <dd><a href="https://w3c.github.io/webappsec-cors-for-developers/">https://w3c.github.io/webappsec-cors-for-developers/</a>
     <dt>Version History:
     <dd><a href="https://github.com/w3c/webappsec-cors-for-developers/commits/master/index.src.html">https://github.com/w3c/webappsec-cors-for-developers/commits/master/index.src.html</a>
     <dt>Issue Tracking:
     <dd><a href="#issues-index">Inline In Spec</a>
     <dt class="editor">Editor:
     <dd class="editor p-author h-card vcard"><a class="p-name fn u-email email" href="mailto:hillbrad@gmail.com">Brad Hill</a> (<a class="p-org org" href="https://facebook.com/">Facebook</a>)
     <dt>Participate:
     <dd><span><a href="https://github.com/w3c/webappsec-cors-for-developers/issues/new">File an issue</a> (<a href="https://github.com/w3c/webappsec-cors-for-developers/issues">open issues</a>)</span>
    </dl>
   </div>
   <div data-fill-with="warning"></div>
   <p class="copyright" data-fill-with="copyright"><a href="http://creativecommons.org/publicdomain/zero/1.0/" rel="license"><img alt="CC0" src="https://licensebuttons.net/p/zero/1.0/80x15.png"></a> To the extent possible under law, the editors have waived all copyright
and related or neighboring rights to this work.
In addition, as of 27 September 2016,
the editors have made this specification available under the <a href="http://www.openwebfoundation.org/legal/the-owf-1-0-agreements/owfa-1-0" rel="license">Open Web Foundation Agreement Version 1.0</a>,
which is available at http://www.openwebfoundation.org/legal/the-owf-1-0-agreements/owfa-1-0.
Parts of this work may be from another specification document.  If so, those parts are instead covered by the license of that specification document. </p>
   <hr title="Separator for header">
  </div>
  <h2 class="no-num no-toc no-ref heading settled" id="abstract"><span class="content">Abstract</span></h2>
  <div class="p-summary" data-fill-with="abstract">
   <p>This Note provides historical and instructional context for developers working with

Cross-Origin Resource Sharing (CORS) and the CORS-mode of Fetch.</p>
  </div>
  <div data-fill-with="at-risk"></div>
  <nav data-fill-with="table-of-contents" id="toc">
   <h2 class="no-num no-toc no-ref" id="contents">Table of Contents</h2>
   <ol class="toc" role="directory">
    <li><a href="#intro"><span class="secno">1</span> <span class="content">Introduction</span></a>
    <li><a href="#beginning"><span class="secno">2</span> <span class="content">Cross-Origin requests at the beginning of the Web</span></a>
    <li>
     <a href="#csrf"><span class="secno">3</span> <span class="content">Cookies, “Ambient Authority” and Cross Site Request Forgery (CSRF)</span></a>
     <ol class="toc">
      <li><a href="#cross-origin-send-permissions-pre-javascript-browsers"><span class="secno">3.1</span> <span class="content">CROSS-ORIGIN SEND PERMISSIONS (pre-Javascript browsers)</span></a>
      <li><a href="#cross-origin-read-permissions-pre-javascript-browsers"><span class="secno">3.2</span> <span class="content">CROSS-ORIGIN READ PERMISSIONS (pre-Javascript browsers)</span></a>
     </ol>
    <li>
     <a href="#script"><span class="secno">4</span> <span class="content">&lt;script>, resources-as-applications, XHR and AJAX</span></a>
     <ol class="toc">
      <li><a href="#cross-origin-send-permissions-simple-safelisted-request"><span class="secno">4.1</span> <span class="content">CROSS-ORIGIN SEND PERMISSIONS (Simple / Safelisted Request)</span></a>
      <li><a href="#cross-origin-read-permissions-simple-safelisted-response"><span class="secno">4.2</span> <span class="content">CROSS-ORIGIN READ PERMISSIONS (Simple / Safelisted Response)</span></a>
     </ol>
    <li>
     <a href="#cors"><span class="secno">5</span> <span class="content">CORS</span></a>
     <ol class="toc">
      <li><a href="#identify-yourself-and-get-permission-simple-request-read-permissions"><span class="secno">5.1</span> <span class="content">Identify Yourself and Get Permission: Simple Request Read Permissions</span></a>
      <li><a href="#getting-additional-send-permissions"><span class="secno">5.2</span> <span class="content">Getting Additional Send Permissions</span></a>
      <li><a href="#anonymous-requests-or-access-control-allow-origin"><span class="secno">5.3</span> <span class="content">Anonymous Requests (or, “Access-Control-Allow-Origin: *”)</span></a>
     </ol>
    <li>
     <a href="#resources"><span class="secno">6</span> <span class="content">Advice for Resource Owners</span></a>
     <ol class="toc">
      <li><a href="#always-send--for-resources-that-respond-uniformly"><span class="secno">6.1</span> <span class="content">Always send * for resources that respond uniformly</span></a>
      <li><a href="#use-vary"><span class="secno">6.2</span> <span class="content">Use Vary</span></a>
      <li><a href="#do-not-blindly-reflect-request-origin-for-credentialed-requests-when-a-resource-may-contain-secrets-or-pii"><span class="secno">6.3</span> <span class="content">Do not blindly reflect request Origin for credentialed requests when a resource may contain secrets or PII</span></a>
     </ol>
    <li><a href="#references"><span class="secno"></span> <span class="content">References</span></a>
    <li><a href="#issues-index"><span class="secno"></span> <span class="content">Issues Index</span></a>
   </ol>
  </nav>
  <main>
   <p class="issue" id="issue-a6cd89cf"><a class="self-link" href="#issue-a6cd89cf"></a> this whole document needs references and terms linkified</p>
   <h2 class="heading settled" data-level="1" id="intro"><span class="secno">1. </span><span class="content">Introduction</span><a class="self-link" href="#intro"></a></h2>
   <p>One of the defining characteristics of a web application is the way in which resources can link and communicate with each other.   Over time, as browsers have evolved and become more powerful, the ways in which web applications can interact has increased.  To maintain security in this feature-rich environment, browsers use a same origin security model and restrict applications from accessing resources across origins. Cross-Origin Resource Sharing (CORS) allows web applications to operate across origins and is therefore one of the most powerful features added to the web platform, but it evolved in an environment full of existing applications that assumed this capability was impossible.  Browsers had to make the impossible possible, securely, and competing proposals had to be negotiated into a single system.   Like many things that are the result of evolution or compromise, there are things about CORS that may seem confusing or inconsistent. Reading the W3C CORS or WHATWG Fetch specification is probably not much help with this confusion, as those documents are oriented towards people building web browsers. This document aims to explain the history and usage of Cross-Origin Resource Sharing for people developing web applications using CORS in the browser, and exposing CORS-aware resources on their servers.</p>
   <h2 class="heading settled" data-level="2" id="beginning"><span class="secno">2. </span><span class="content">Cross-Origin requests at the beginning of the Web</span><a class="self-link" href="#beginning"></a></h2>
   <p>In the early days of browsers, a resource could interact with other resources in a very small number of ways.  You could use an anchor to make a GET request, which would also navigate the browser, so the previous page couldn’t see the results.  You could use a form to make a GET or POST request, which would also navigate the browser.  Or you could include resources into your page, like images - but you couldn’t access the content of these images or other resources included in this way.</p>
   <h2 class="heading settled" data-level="3" id="csrf"><span class="secno">3. </span><span class="content">Cookies, “Ambient Authority” and Cross Site Request Forgery (CSRF)</span><a class="self-link" href="#csrf"></a></h2>
   <p>HTTP is a stateless protocol, but state can be useful.  For instance, you would probably not like to have to enter your password on every single request to an authenticated application.  Cookies filled this role and emerged very early in the history of the web.  A cookie allows a site to save a small amount of client side state.  At a time when documents were static, cookies were the first browser feature to need access control policies enforced by the client - roughly, the browser would only send cookies back to the site that set them, as determined by the scheme and host of the resource.  So, e.g., <strong>https://bank-example.com/a.html</strong> could set a cookie that <strong>https://bank-example.com/b.html</strong> could read (as part of a future request, only later through script), but <strong>https://evil-example.com/bad.html</strong> could not access.</p>
   <p>Browsers save cookies as the user navigates through many different application domains, and send them any time a matching request is issued.  This led to the first cross-origin security problems.  For example, although <strong>https://evil-example.com</strong> can’t read <strong>https://bank-example.com</strong>’s cookies and access your account directly, it could create a form that sent a POST to <strong>https://bank-example.com/transferFunds</strong> with instructions to transfer money to a different account.  The request would be sent with your cookie, and the bank might execute the transfer as if it it was on your instructions.  This kind of attack is called <em>Cross Site Request Forgery</em> (CSRF), a class of the “Confused Deputy” problem.  CSRF is enabled by the fact that the authorization conveyed by the cookie is present in the browser and attached to every request by default, without requiring additional user action, for any request where the cookie is in scope, regardless of where the request originated.  This style of access control interaction is often referred to as <em>ambient authority</em>.  Managing ambient authority and defending against CSRF are key motivators for much of the subsequent evolution of the web security model, including CORS.</p>
   <div class="note" role="note"> If you are developing for the web platform and are used to writing apps for a platform like Android or iOS, you may wonder why your web app can’t make any request and read the results as it is possible to do with the platform native APIs. <br> <br> Compared to the model of most mobile operating sytems that isolates data and state between different apps and defines inter-process communication channels that often require an explicit context switch between apps, a general purpose web browser gives users the ability to move seamlessly between (and even interact with embeddded) application contexts with different security principals while retaining all of their state, authority and customizations, and to do complex communications across domains without reauthenticating everywhere.  This is incredibly powerful, but to protect the user the browser must also act as a security monitor, assuming the role the trusted operating system does on a mobile platform, to isolate potentially malicious resources the user might browse or be directed to from data it should not have access to. </div>
   <p>Although it wasn’t thought of this way at the time, we can represent what the early browser did with cross-origin requests in terms of an access control table.  Later on, we can see how CORS allows us to modify the permissions in this table. Rather than the read/write permissions you might use for a local file, for HTTP requests we will think in terms of permissions to SEND requests and READ the results.  SEND permissions are the types and attributes of requests a resource is allowed to make from the browser.  READ permissions are the types and attributes of responses a resource is allowed by the browser to access.  The following are the things a conforming user agent could do, explicitly or implicitly, with cross-origin resources:</p>
   <h3 class="heading settled" data-level="3.1" id="cross-origin-send-permissions-pre-javascript-browsers"><span class="secno">3.1. </span><span class="content">CROSS-ORIGIN SEND PERMISSIONS (pre-Javascript browsers)</span><a class="self-link" href="#cross-origin-send-permissions-pre-javascript-browsers"></a></h3>
   <table class="accessControlTable">
    <tbody>
     <tr class="allowed">
      <td>GET, with cookies
      <td>ALLOWED
     <tr class="allowed">
      <td>POST, with cookies
      <td>ALLOWED
     <tr class="disallowed">
      <td>PUT, DELETE, etc., with cookies
      <td>DISALLOWED
     <tr class="allowed">
      <td>Set header value: Accept
      <td>USER-CONTROLLED*
     <tr class="allowed">
      <td>Set header value: Accept-Language
      <td>USER-CONTROLLED*
     <tr class="allowed">
      <td>Set header value: Content-Language
      <td>USER-CONTROLLED*
   </table>
   <h3 class="heading settled" data-level="3.2" id="cross-origin-read-permissions-pre-javascript-browsers"><span class="secno">3.2. </span><span class="content">CROSS-ORIGIN READ PERMISSIONS (pre-Javascript browsers)</span><a class="self-link" href="#cross-origin-read-permissions-pre-javascript-browsers"></a></h3>
   <table class="accessControlTable">
    <tbody>
     <tr class="disallowed">
      <td>Cookies
      <td>DISALLOWED
     <tr class="disallowed">
      <td>Resource body
      <td>DISALLOWED
     <tr class="disallowed">
      <td>Read header values
      <td>DISALLOWED
   </table>
   <h2 class="heading settled" data-level="4" id="script"><span class="secno">4. </span><span class="content">&lt;script>, resources-as-applications, XHR and AJAX</span><a class="self-link" href="#script"></a></h2>
    With the introduction of Javascript, active resources came to the web. (plugins are their own topic, of thankfully ever-decreasing relevance)  This raised interesting challenges about the security perimeter for the web-resource-as-application: how to allow rich interactivity that is useful and powerful without breaking the security of existing services and resources?  Netscape decided to go with a security model similar to that of cookies.  The Same Origin Policy, as it was called, came to be the foundational strategy for client-side web application security.  The security boundaries of a resource are defined by its Origin, the URI scheme/host/port tuple where it was loaded from.  Under the Same Origin Policy, a resource has authority to read from and send to other resources with few restrictions when they are Same-Origin, but it cannot read and send to cross-origin resources, except as previously allowed in our permission tables above.  The XMLHttpRequest and introduction of the async request pattern followed after Javascript and adhered to the same basic rules. 
   <div class="note" role="note">
     <strong>Leaks at the edges of the Same Origin Policy model</strong> 
    <p>
     The Same Origin Policy is conceptually simple, but it has a few complications and edge cases.  Firstly, resources-as-applications can query their internal state in a way that leaks some information about previously opaque requests and responses, like whether an 
     <tt>&lt;img></tt>
      load failed or was successful, and what the dimensions of the image are, even if access to the actual pixel content is prevented cross-origin.
    </p>
    <p>
     More importantly, because the 
     <tt>&lt;script></tt>
      tag was not limited to only loading Same-Origin resources, cross-origin documents can implicitly read the response content of the script through its (often deliberate) side-effects.  This led to some interesting security vulnerabilities and also some interesting ways to do cross-origin mashup applications.
    </p>
    <p>
     On the vulnerability side, 
     <tt>&lt;script></tt>
      introduced a new possibility for CSRF-type attacks that would actually disclose the contents of the response.  E.g. if <strong>https://bank-example.com/getBalanceAsync</strong> provides a resource that looks up the user’s balance using the cookies attached to the request, then returns a script that does a 
     <tt>document.write()</tt>
      of that information, any other site on the internet could include that resource with a 
     <tt>&lt;script></tt>
      tag on their own site and read your account balance.  This is why you often see Javascript resources that begin with a guard statement like 
     <tt>for(;;) {}</tt>
     .  This infinite loop blocks the thread and prevents access to the information that follows, except by a Same-Origin caller that can access the response contents explicitly with an async request and read past the guard.
    </p>
    <p>The script-read loophole also became widely used to deliberately exchange information across origins with a pattern called JSONP. (JSON with Padding)  In this use, a JSON response is padded with a function specified by the caller to allow cross-origin data transfer.  So if <strong>https://brokerage-example.com</strong> included:</p>
    <tt>&lt;script src=”https://bank-example.com/jsonp.js?callback=foo”></tt>
    , 
    <p><strong>https://bank-example.com</strong> could respond with a payload that lookes like:</p>
    <tt>foo({accountNumber: 12345});</tt>
    <p>
     Which would invoke the 
     <tt>foo()</tt>
      function in the context of the <strong>https://brokerage-example.com</strong> resource and give it access to the account number.
    </p>
    <p>While extremely useful, JSONP and cross-origin script inclusion generally are dangerous patterns.  JSONP is really just “friendly” Cross-Site Scripting.  A resource using JSONP must completely trust the remote resource not to be malicious or compromised; the payload could just as easily be an information-stealing script as an information-passing one and it will be executed in the security domain of the caller, whatever it contains.  A resource providing JSONP responses must also be careful not to send them to the wrong origins. Enabling cross-origin async data exchange in a more secure manner than JSONP was a motivating use case in the design of CORS.</p>
   </div>
   <p>The browser permissions table, post-Javascript but pre-CORS, looks as follows.  The CORS specification refers to requests and responses that fall within this permission set as “simple” requests and responses, and the Fetch specification calls these methods and headers “safelisted”.</p>
   <h3 class="heading settled" data-level="4.1" id="cross-origin-send-permissions-simple-safelisted-request"><span class="secno">4.1. </span><span class="content">CROSS-ORIGIN SEND PERMISSIONS (Simple / Safelisted Request)</span><a class="self-link" href="#cross-origin-send-permissions-simple-safelisted-request"></a></h3>
   <table class="accessControlTable">
    <tbody>
     <tr class="allowed">
      <td>GET, with cookies
      <td>ALLOWED
     <tr class="allowed">
      <td>POST, with cookies
      <td>ALLOWED
     <tr class="disallowed">
      <td>PUT, DELETE, etc., with cookies
      <td>DISALLOWED
     <tr class="allowed">
      <td>Set header value: Accept
      <td>USER-CONTROLLED
     <tr class="allowed">
      <td>Set header value: Accept-Language
      <td>USER-CONTROLLED
     <tr class="allowed">
      <td>Set header value: Content-Language
      <td>USER-CONTROLLED
     <tr class="partial">
      <td>Set header value: Content-Type
      <td>
       PARTIAL: 
       <tt>application/x-www-form-urlencoded</tt>
       , 
       <tt>multipart/form-data</tt>
       ,
		or 
       <tt>text/plain</tt>
     <tr class="disallowed">
      <td>Set header value: anything else
      <td>DISALLOWED
   </table>
   <p>User agents with implement the Fetch specification also allow the following headers to
be sent as part of a simple / safelisted request, so long as the value, once parsed is
not a failure:</p>
   <table class="accessControlTable">
    <tbody>
     <tr class="allowed">
      <td>Set header value: DPR
      <td>ALLOWED
     <tr class="allowed">
      <td>Set header value: Downlink
      <td>ALLOWED
     <tr class="allowed">
      <td>Set header value: Save-Data
      <td>ALLOWED
     <tr class="allowed">
      <td>Set header value: Viewport-Width
      <td>ALLOWED
     <tr class="allowed">
      <td>Set header value: Width
      <td>ALLOWED
   </table>
   <h3 class="heading settled" data-level="4.2" id="cross-origin-read-permissions-simple-safelisted-response"><span class="secno">4.2. </span><span class="content">CROSS-ORIGIN READ PERMISSIONS (Simple / Safelisted Response)</span><a class="self-link" href="#cross-origin-read-permissions-simple-safelisted-response"></a></h3>
   <table class="accessControlTable">
    <tbody>
     <tr class="disallowed">
      <td>Cookies
      <td>DISALLOWED
     <tr class="disallowed">
      <td>Resource body
      <td>DISALLOWED (some side effects like response status and image size may be observable from scripts)
     <tr class="partial">
      <td>&lt;script> resource body
      <td>PARTIAL (implict access to declared variables and side effects of functions)
     <tr class="disallowed">
      <td>Read header values
      <td>DISALLOWED
   </table>
   <h2 class="heading settled" data-level="5" id="cors"><span class="secno">5. </span><span class="content">CORS</span><a class="self-link" href="#cors"></a></h2>
    As Javascript and AJAX became ubiquitous on the web and the browser became a rich client-side application platform, people wanted to be able to do more complex things with cross-origin requests (as compared to the old “simple” requests and responses). 
   <p>Enter Cross-Origin Resource Sharing.  The challenge when designing CORS was how to enable web applications to request and receive more permissions to read and write cross-origin, without exposing existing applications to new attacks.  By the time CORS arrived on the scene, there were already billions of HTTP resources, used by a wide array of applications beyond the traditional browser.  Many of those resources relied implicitly on the permission table we have seen so far for security.  For example, they might expose a privileged endpoint on an intranet, but check for a special HTTP request header that only a non-browser or same-origin client could set, to protect themselves from CSRF-type attacks. Enabling CORS couldn’t suddenly make all those existing applications vulnerable; it needed to evolve the web platform in a way that preserved backwards-compatibility for cross-origin security.</p>
   <h3 class="heading settled" data-level="5.1" id="identify-yourself-and-get-permission-simple-request-read-permissions"><span class="secno">5.1. </span><span class="content">Identify Yourself and Get Permission: Simple Request Read Permissions</span><a class="self-link" href="#identify-yourself-and-get-permission-simple-request-read-permissions"></a></h3>
    The way to expand the permissions available to invoke and read cross-origin resources safely is to identify yourself to the foreign resource and have it grant you additional privileges.  This extending of the access control table is at the heart of Cross-Origin Resource Sharing. 
   <p>First: how to identify yourself?  The Javascript Same Origin Policy made the Origin the main security boundary / principal for the web, so this is how you identify yourself to request new permissions.  Whenever you make a request in CORS mode, the browser will add an HTTP header, “Origin”, identifying the context from which the request originated.</p>
   <p>Next: how to get extra permissions? If you are making a cross-origin request already allowed by the pre-CORS permission table (AKA a “simple” request) all you need to is let the browser send an Origin header with the request.  When it receives such a request, the foreign resource can examine the Origin header of the request and decide to grant it additional Read permissions.</p>
   <p>If a simple CORS request (withCredentials=true) and an Origin header were initiated with XMLHttpRequest or the Fetch API by a resource with an Origin of <strong>https://example.com</strong>, and the response from the resource included the following:</p>
<pre>Access-Control-Allow-Origin: https://example.com
Access-Control-Allow-Credentials: true
Access-Control-Expose-Headers: Special-Response-Header, Header2
</pre>
   <p>The browser would add the following entries to the read permissions table for <strong>https://example.com</strong> regarding that response:</p>
   <table class="accessControlTable">
    <tbody>
     <tr class="allowed">
      <td>Resource body
      <td>ALLOWED
     <tr class="allowed">
      <td>Read header value: Special-Response-Header
      <td>ALLOWED
     <tr class="allowed">
      <td>Read header value: Header2
      <td>ALLOWED
   </table>
   <p>
    The 
    <tt>Access-Control-Allow-Origin</tt>
     header tells the browser which Origin can read the response body. The 
    <tt>Access-Control-Allow-Credentials</tt>
     header in the response tells the browser it is OK to expose the response for a request that included cookies. (more about that in a bit) The 
    <tt>Access-Control-Allow-Headers</tt>
     header (which is optional in a CORS response) lists headers in the response that the resource from <strong>https://example.com</strong> is able to read.
   </p>
   <p>
    When any matching 
    <tt>Access-Control-Allow-Origin</tt>
     response is received, read permission is also granted <em>implicitly</em> for a number of headers deemed to be at low risk of containing sensitive information:
   </p>
   <table class="accessControlTable">
    <tbody>
     <tr class="allowed">
      <td>Read header value: Cache-Control
      <td>ALLOWED
     <tr class="allowed">
      <td>Read header value: Content-Language
      <td>ALLOWED
     <tr class="allowed">
      <td>Read header value: Content-Type
      <td>ALLOWED
     <tr class="allowed">
      <td>Read header value: Expires
      <td>ALLOWED
     <tr class="allowed">
      <td>Read header value: Last-Modified
      <td>ALLOWED
     <tr class="allowed">
      <td>Read header value: Pragma
      <td>ALLOWED
   </table>
   <div class="note" role="note">
     <strong>A Few Caveats for CORS Read Permissions</strong> 
    <p>
     Although the CORS specification implies that you can list multiple origins in the 
     <tt>Access-Control-Allow-Origin</tt>
      header, in practice only a single value is allowed by all modern browsers.  The multiple value syntax was intended to allow all origins in a redirect chain to be listed, as allowed by RFC6454, but this was never implemented.
    </p>
    <p>
     If a cross-origin resource redirects to another resource at a new origin, the browser will set the value of the Origin header to 
     <tt>null</tt>
      after redirecting.  This prevents additional confused deputy attacks, but a cost of making it difficult to transparently move CORS resources that support (cookie-based) credentials and simple requests across domains with 3xx status codes as one can with non-CORS resources.  It is possible to redirect same-origin resources to a cross-origin location (single hop only) because browsers will transparently apply the CORS algorithm to such requests and include the Origin header for the first hop.
    </p>
    <p>To make possible transparent movement of CORS-enabled resources accessed via simple requests requires work and coordination by servers.  For example, a resource at <strong>https://old.example.com/resource</strong> might respond to a CORS request with credentals with a redirect to <strong>https://new.example.com/resource?originalOrigin=...&amp;credential=...</strong> which would carry the authority to access the resource in the URL parameter instead of the Cookie and Origin headers.  The server at <strong>https://new.example.com</strong> would need custom logic to recognize and authenticate these parameters and perform appropriate authorization before returning <em>Access-Control-Allow-</em> headers to the user agent.</p>
    <p>Requests which require a prefilight can transit multiple origins in user agents that implement recent versions of the WHATWG Fetch specification which instruct the preflight request be transparently re-issued to the new target using the pre-redirect value of the Origin header.</p>
   </div>
   <div class="note" role="note">
     <strong>No Sharing of Cookies</strong> 
    <p>As security-critical access control tokens, browsers will not allow cookies to be shared.  So the following response headers cannot be accessed, even if listed in Access-Control-Expose-Headers.</p>
    <ul>
     <li data-md="">
      <tt>Set-Cookie</tt>
     <li data-md="">
      <tt>Set-Cookie2</tt>
    </ul>
   </div>
   <h3 class="heading settled" data-level="5.2" id="getting-additional-send-permissions"><span class="secno">5.2. </span><span class="content">Getting Additional Send Permissions</span><a class="self-link" href="#getting-additional-send-permissions"></a></h3>
   <p>What if you want to make a request that isn’t allowed by the simple request permissions table?  To protect legacy resources that may not understand CORS, you must first ask permission to expand your send privileges.  This permission granting is done with a “preflight request”.   If you are writing the client side of an application, the browser will take care of most of this for you.  You simply enable CORS and make your request.  If, e.g., you wanted to send a cross-origin PUT request and set the header “Special-Request-Header: foobar”, the browser would automatically send a preflight request.  That preflight would include the following:</p>
<pre>Origin: https://example.com
Access-Control-Request-Method: PUT
Access-Control-Request-Headers: Special-Request-Header
</pre>
   <p>If the resource is CORS-aware and supports these options, it might respond to this preflight request with:</p>
<pre>Access-Control-Allow-Origin: https://example.com
Access-Control-Allow-Method: PUT
Access-Control-Allow-Headers: Special-Request-Header
Access-Control-Allow-Credentials: true
Access-Control-Max-Age: 60
</pre>
   <p>
    This adds the following entries to the permission table for 
    <tt>https://example.com</tt>
    :
   </p>
   <table class="accessControlTable">
    <tbody>
     <tr class="allowed">
      <td>PUT, with cookies
      <td>ALLOWED (for 60 seconds)
     <tr class="allowed">
      <td>Set header: Special-Request-Header
      <td>ALLOWED (for 60 seconds)
   </table>
   <p>
    The browser will then transparently make the actual request if the correct permissions were granted, and return the response with any new read permissions granted by the read permission headers described above.  The 
    <tt>Access-Control-Max-Age</tt>
     header in the preflight response is optional, and allows the permission grant to be cached. If it is not present, a preflight must be made before each non-simple request.
   </p>
   <div class="note" role="note">
     <strong>Caveats for CORS Send Permissions</strong> 
    <p>For security and correctness reasons, a number of headers are forbidden to be set by a same-origin or CORS-authorized caller, even if the preflight ceremony is completed. These include:</p>
    <ul>
     <li data-md="">
      <tt>Accept-Charset</tt>
     <li data-md="">
      <tt>Accept-Encoding</tt>
     <li data-md="">
      <tt>Access-Control-Request-Headers</tt>
     <li data-md="">
      <tt>Access-Control-Request-Method</tt>
     <li data-md="">
      <tt>Connection</tt>
     <li data-md="">
      <tt>Content-Length</tt>
     <li data-md="">
      <tt>Cookie</tt>
     <li data-md="">
      <tt>Cookie2</tt>
     <li data-md="">
      <tt>Date</tt>
     <li data-md="">
      <tt>DNT</tt>
     <li data-md="">
      <tt>Expect</tt>
     <li data-md="">
      <tt>Host</tt>
     <li data-md="">
      <tt>Keep-Alive</tt>
     <li data-md="">
      <tt>Origin</tt>
     <li data-md="">
      <tt>Referer</tt>
     <li data-md="">
      <tt>TE</tt>
     <li data-md="">
      <tt>Trailer</tt>
     <li data-md="">
      <tt>Transfer-Encoding</tt>
     <li data-md="">
      <tt>Upgrade</tt>
     <li data-md="">
      <tt>Via</tt>
     <li data-md="">
      <p>
       <em>Or any header beginning with</em> 
       <tt>Proxy-</tt>
        <em>or</em> 
       <tt>Sec-</tt>
      </p>
    </ul>
    <p><strong>Caveat caveats</strong></p>
    <p>
     Some server-side application frameworks, notably those that coerce HTTP headers into UNIX environment variables such as PHP or Perl CGIs, transparently translate hyphens to underscore characters when exposing headers to the application.  This means that a CORS client may be able to set headers that begin with 
     <tt>Proxy_</tt>
      or 
     <tt>Sec_</tt>
      which will be indistinguishable to these applications from their hyphenated equivalents which are banned by browsers.
    </p>
   </div>
   <h3 class="heading settled" data-level="5.3" id="anonymous-requests-or-access-control-allow-origin"><span class="secno">5.3. </span><span class="content">Anonymous Requests (or, “Access-Control-Allow-Origin: *”)</span><a class="self-link" href="#anonymous-requests-or-access-control-allow-origin"></a></h3>
   <p>In addition to credentialed requests, CORS sought to solve one additional use case.  Some resources on the web are truly public, and can be read by anyone.  Before CORS, an application could access such resources by requesting that its origin server proxy them.  This was safe because the proxy server had no ambient authority - that is, it couldn’t make those requests with users’ cookies, it could only return public content available to anyone.</p>
   <p>While this worked, it was wasteful of resources, high-latency, and prevented building some classes of server-less applications in the browser.  CORS allows such resources to be requested and accessed directly with anonymous requests. (In fact, it is the default mode of CORS.)</p>
   <p>
    Unlike the previous values for 
    <tt>Access-Control-Allow-Origin</tt>
     headers we’ve seen, which add values to the discretionary access control table, anonymous requests follow a mandatory access control model.  If a request is marked as accessible to anonymous requests, it is only accessible to anonymous requests.
   </p>
   <p>How does this work?  A resource simply includes the following header in its response:</p>
<pre>Access-Control-Allow-Origin: *
</pre>
   <p>
    (and optionally an 
    <tt>Access-Control-Allow-Headers</tt>
     header indicating allowed headers)
   </p>
   <p>
    Upon seeing this, the browser will grant access to the response (and indicated headers) <em>if and only if</em> the request was made anonymously.  An anonymous request can be made by setting the 
    <tt>withCredentials</tt>
     on an 
    <tt>XMLHttpRequest</tt>
     to 
    <tt>false</tt>
     (the default), which causes the browser to omit the 
    <tt>Cookie</tt>
     headers in the request.
   </p>
   <p class="issue" id="issue-1b03248a"><a class="self-link" href="#issue-1b03248a"></a> document how to do this with Fetch API</p>
   <p>
    Anonymous requests are also special in that responses do not change the state of the browser.  If you started anonymous, you stay anonymous after an anonymous request.  So, although a resource accessed without credentials using CORS might send a 
    <tt>Set-Cookie</tt>
     header, such headers would be ignored.  Even the response is not stored in the normal browser cache, although it might be cached in a special location just for anonymous requests.
   </p>
   <div class="note" role="note">
     <strong>Why does <tt>*</tt> mean “anonymous requests only” and not “everyone”?</strong> 
    <p>
     The use of the asterisk by CORS can be confusing in the context of an otherwise discretionary access control model.  It is intended only to replace the proxy use case for static resources or those that respond uniformly to requests from all origins.  It may help to think of 
     <tt>*</tt>
      as a mandatory, not a discretionary control.  A 
     <tt>*</tt>
      says a resource is accessible to anybody, but if your cookies and Origin header told me who you are, you’re not “anybody” anymore - now you are somebody.
    </p>
    <p>An unfortunate consequence of this model, however, is that a CORS client must know in advance if the contract of a resource it is requesting requires anonymous or credentialed access, or it must implement client-side failure and retry logic.  This can be problematic when designing something like an open data explorer if all potential data sources do not uniformly respond to anonymous requests.</p>
    <p>
     <strong>The story behind <tt>*</tt></strong> Why does the 
     <tt>*</tt>
      mode of CORS behave so differently than the credentialed mode? Given the already long history of web vulnerabilities attributable to abuse of ambient authority, there were two schools of thought about how to expand the web platform with cross-origin requests at the time CORS was developed.  One camp proposed extending the already-familiar ambient authority model in which the user agent transparently adds cookies to requests and performs permission management for resources.  The other camp felt that ambient authority was a mistake in the architecture of the web, and advocated for cross-origin requests free of any ambient credentials or origin-based authentication.  (Which, they also argued, could be exempt from the Same Origin Policy entirely, since such requests were equivalent to loading from an unprivileged proxy.)  The 
     <tt>XDomainRequest</tt>
      object in Microsoft Internet Explorer 8 and 9 retained some of this style - it had no support for credentials, only anonymous requests, although it also used the same 
     <tt>Access-Control-[...]</tt>
      headers.
    </p>
    <p>
     The familiarity of the ambient authority model of CORS and its ability to slot easily into existing application authentication and authorization frameworks eventually won more favor with developers than re-designing their applications in a capability-security style, (https://www.w3.org/TR/capability-urls/) but the anonymous request mode was retained as a “subset” of CORS.  Unfortunately, the subtle differences in architectural style that persisted and the choice of 
     <tt>*</tt>
      to represent such requests has been a consistent source of confusion.
    </p>
    <p>
     Although the purest vision for anonymous requests wanted to do away with any need for permission grants, it was decided that an 
     <tt>Access-Control-Allow-Origin</tt>
      header must still be required in order to protect legacy resources that rely on ambient authority outside of the control of the browser.  Network topology is the most common example of this sort of authority.  E.g. a resource on an intranet might assume that only trusted clients on the same physical network can reach it and so impose no access controls.  If those same clients also fetch resources from the public internet and there were no requirement for the opt-in header, a remote resource could possibly “pivot” through a browser on the trusted network to access and exfiltrate information from those unprotected services.
    </p>
    <p>
     Responses with 
     <tt>*</tt>
      are not truly uniform, either.  Because the user agent always sends the Origin header for a CORS requests, even those made without credentials, a server might choose to very its response based on that information.
    </p>
   </div>
   <h2 class="heading settled" data-level="6" id="resources"><span class="secno">6. </span><span class="content">Advice for Resource Owners</span><a class="self-link" href="#resources"></a></h2>
    Providing resources for cross-origin consumption requires some work, as well. 
   <h3 class="heading settled" data-level="6.1" id="always-send--for-resources-that-respond-uniformly"><span class="secno">6.1. </span><span class="content">Always send * for resources that respond uniformly</span><a class="self-link" href="#always-send--for-resources-that-respond-uniformly"></a></h3>
    It is always safe to return 
   <tt>Access-Control-Allow-Origin: *</tt>
    for static resources that do not respond differently based on cookies or other distinguishing characteristics of the request.  Such resources could always be fetched into the context of any foreign resource via a proxy, so allowing read access is an optimization that has no additional security or privacy implications.  Sending * is part of being a good citizen of the Web as it allows browser-based applications like podcast aggregators or Open Data browsers to access your resources as a native app equivalent might, without needing a proxy server. 
   <h3 class="heading settled" data-level="6.2" id="use-vary"><span class="secno">6.2. </span><span class="content">Use Vary</span><a class="self-link" href="#use-vary"></a></h3>
    If a resource requires credentials, it cannot return 
   <tt>*</tt>
   , it must reflect the Origin header value from the request.  This implies that, unless the response explicitly indicates it should never be cached, it should also send a 
   <tt>Vary: Origin</tt>
    header to keep the browser from re-using the response and denying access to requests from other origins that might be authorized. 
   <p>
    If a resource is intended to be readable, truly regardless of the context of the request, first it should take care not to actually vary and reveal private information based on the presence and content of a cookie.  Then it should send 
    <tt>Vary: Cookie, Origin</tt>
     and either 
    <tt>Access-Control-Allow-Origin: *</tt>
     for requests made without cookies or reflect the request’s Origin into the 
    <tt>Access-Control-Allow-Origin</tt>
     header for credentialed requests.
   </p>
   <h3 class="heading settled" data-level="6.3" id="do-not-blindly-reflect-request-origin-for-credentialed-requests-when-a-resource-may-contain-secrets-or-pii"><span class="secno">6.3. </span><span class="content">Do not blindly reflect request Origin for credentialed requests when a resource may contain secrets or PII</span><a class="self-link" href="#do-not-blindly-reflect-request-origin-for-credentialed-requests-when-a-resource-may-contain-secrets-or-pii"></a></h3>
    If your resource includes customized, per-user content, it should not expose such information cross-origin.  Consider carefully if "public" content may inadvertantly include things like session tokens, anti-CSRF tokens, grettings that expose personally identifying information like user names, or comments that contain uniquely identifying identifiers.  Such things exposed blindly cross-origin may compromise the security and privacy of your users by providing a stable identifier that can track them across all their activities on the web or allow hijacking of their account. (even though cookie headers are never shared with CORS) 
  </main>
<script>
(function() {
  "use strict";
  var collapseSidebarText = '<span aria-hidden="true">←</span> '
                          + '<span>Collapse Sidebar</span>';
  var expandSidebarText   = '<span aria-hidden="true">→</span> '
                          + '<span>Pop Out Sidebar</span>';
  var tocJumpText         = '<span aria-hidden="true">↑</span> '
                          + '<span>Jump to Table of Contents</span>';

  var sidebarMedia = window.matchMedia('screen and (min-width: 78em)');
  var autoToggle   = function(e){ toggleSidebar(e.matches) };
  if(sidebarMedia.addListener) {
    sidebarMedia.addListener(autoToggle);
  }

  function toggleSidebar(on) {
    if (on == undefined) {
      on = !document.body.classList.contains('toc-sidebar');
    }

    /* Don’t scroll to compensate for the ToC if we’re above it already. */
    var headY = 0;
    var head = document.querySelector('.head');
    if (head) {
      // terrible approx of "top of ToC"
      headY += head.offsetTop + head.offsetHeight;
    }
    var skipScroll = window.scrollY < headY;

    var toggle = document.getElementById('toc-toggle');
    var tocNav = document.getElementById('toc');
    if (on) {
      var tocHeight = tocNav.offsetHeight;
      document.body.classList.add('toc-sidebar');
      document.body.classList.remove('toc-inline');
      toggle.innerHTML = collapseSidebarText;
      if (!skipScroll) {
        window.scrollBy(0, 0 - tocHeight);
      }
      tocNav.focus();
      sidebarMedia.addListener(autoToggle); // auto-collapse when out of room
    }
    else {
      document.body.classList.add('toc-inline');
      document.body.classList.remove('toc-sidebar');
      toggle.innerHTML = expandSidebarText;
      if (!skipScroll) {
        window.scrollBy(0, tocNav.offsetHeight);
      }
      if (toggle.matches(':hover')) {
        /* Unfocus button when not using keyboard navigation,
           because I don’t know where else to send the focus. */
        toggle.blur();
      }
    }
  }

  function createSidebarToggle() {
    /* Create the sidebar toggle in JS; it shouldn’t exist when JS is off. */
    var toggle = document.createElement('a');
      /* This should probably be a button, but appearance isn’t standards-track.*/
    toggle.id = 'toc-toggle';
    toggle.class = 'toc-toggle';
    toggle.href = '#toc';
    toggle.innerHTML = collapseSidebarText;

    sidebarMedia.addListener(autoToggle);
    var toggler = function(e) {
      e.preventDefault();
      sidebarMedia.removeListener(autoToggle); // persist explicit off states
      toggleSidebar();
      return false;
    }
    toggle.addEventListener('click', toggler, false);


    /* Get <nav id=toc-nav>, or make it if we don’t have one. */
    var tocNav = document.getElementById('toc-nav');
    if (!tocNav) {
      tocNav = document.createElement('p');
      tocNav.id = 'toc-nav';
      /* Prepend for better keyboard navigation */
      document.body.insertBefore(tocNav, document.body.firstChild);
    }
    /* While we’re at it, make sure we have a Jump to Toc link. */
    var tocJump = document.getElementById('toc-jump');
    if (!tocJump) {
      tocJump = document.createElement('a');
      tocJump.id = 'toc-jump';
      tocJump.href = '#toc';
      tocJump.innerHTML = tocJumpText;
      tocNav.appendChild(tocJump);
    }

    tocNav.appendChild(toggle);
  }

  var toc = document.getElementById('toc');
  if (toc) {
    createSidebarToggle();
    toggleSidebar(sidebarMedia.matches);

    /* If the sidebar has been manually opened and is currently overlaying the text
       (window too small for the MQ to add the margin to body),
       then auto-close the sidebar once you click on something in there. */
    toc.addEventListener('click', function(e) {
      if(e.target.tagName.toLowerCase() == "a" && document.body.classList.contains('toc-sidebar') && !sidebarMedia.matches) {
        toggleSidebar(false);
      }
    }, false);
  }
  else {
    console.warn("Can’t find Table of Contents. Please use <nav id='toc'> around the ToC.");
  }

  /* Wrap tables in case they overflow */
  var tables = document.querySelectorAll(':not(.overlarge) > table.data, :not(.overlarge) > table.index');
  var numTables = tables.length;
  for (var i = 0; i < numTables; i++) {
    var table = tables[i];
    var wrapper = document.createElement('div');
    wrapper.className = 'overlarge';
    table.parentNode.insertBefore(wrapper, table);
    wrapper.appendChild(table);
  }

})();
</script>
  <h2 class="no-num no-ref heading settled" id="references"><span class="content">References</span><a class="self-link" href="#references"></a></h2>
  <h2 class="no-num no-ref heading settled" id="issues-index"><span class="content">Issues Index</span><a class="self-link" href="#issues-index"></a></h2>
  <div style="counter-reset:issue">
   <div class="issue"> this whole document needs references and terms linkified<a href="#issue-a6cd89cf"> ↵ </a></div>
   <div class="issue"> document how to do this with Fetch API<a href="#issue-1b03248a"> ↵ </a></div>
  </div>